<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
	x:Class="MyFactory.MauiClient.Pages.MaterialsAndSuppliers.SupplierOrders.SupplierOrderUpdatePage"
	xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
	xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
	xmlns:view_model="clr-namespace:MyFactory.MauiClient.ViewModels.MaterialsAndSuppliers.SupplierOrders"
	Title="Редактирование заказа поставщику"
	x:DataType="view_model:SupplierOrderUpdatePageViewModel">
	<Grid
		Padding="16"
		RowDefinitions="Auto,*,Auto"
		RowSpacing="12">
		<VerticalStackLayout>
			<Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="8">
				<Label
					FontAttributes="Bold"
					FontSize="18"
					Text="Редактирование заказа" />
				<Button
					Grid.Column="1"
					Command="{Binding DeleteOrderCommand}"
					Text="Удалить заказ" />
				<Button
					Grid.Column="2"
					Command="{Binding CompleteCommand}"
					Text="Завершить заказ" />
			</Grid>
			<Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="8">
				<Button
					Grid.Column="1"
					Command="{Binding AddItemCommand}"
					Text="+" />
				<Button
					Grid.Column="2"
					Command="{Binding RemoveSelectedCommand}"
					IsEnabled="{Binding HasSelectedItems}"
					IsVisible="{Binding HasSelectedItems}"
					Text="-" />
			</Grid>
		</VerticalStackLayout>

		<Border Grid.Row="1" VerticalOptions="Fill">
			<Grid RowDefinitions="Auto,*" RowSpacing="8">
				<Grid
					Padding="0,4"
					ColumnDefinitions="2*,1.2*,1.6*,1*,1*"
					ColumnSpacing="8">
					<Label FontAttributes="Bold" Text="Поставщик" />
					<Label
						Grid.Column="1"
						FontAttributes="Bold"
						Text="Тип" />
					<Label
						Grid.Column="2"
						FontAttributes="Bold"
						Text="Материал" />
					<Label
						Grid.Column="3"
						FontAttributes="Bold"
						Text="Количество" />
					<Label
						Grid.Column="4"
						FontAttributes="Bold"
						HorizontalTextAlignment="End"
						Text="Цена" />
				</Grid>

				<CollectionView
					x:Name="SupplierOrderItemsCollection"
					Grid.Row="1"
					ItemsSource="{Binding Items}"
					SelectedItems="{Binding SelectedItems, Mode=TwoWay}"
					SelectionMode="Multiple">
					<CollectionView.ItemTemplate>
						<DataTemplate x:DataType="view_model:SupplierOrderUpdatePageViewModel+OrderItemViewModel">
							<Grid
								Padding="32,0,6,0"
								ColumnDefinitions="2*,1.2*,1.6*,1*,1*"
								ColumnSpacing="8"
								Style="{StaticResource SelectableItemGridStyle}">
								<Label
									FontAttributes="Italic"
									Text="{Binding Supplier.Name}"
									VerticalTextAlignment="Center" />
								<Label
									Grid.Column="1"
									FontAttributes="Italic"
									Text="{Binding MaterialType}"
									VerticalTextAlignment="Center" />
								<Label
									Grid.Column="2"
									FontAttributes="Italic"
									Text="{Binding Material.Name}"
									VerticalTextAlignment="Center" />
								<Entry
									Grid.Column="3"
									Keyboard="Numeric"
									Text="{Binding Qty}" />
								<Entry
									Grid.Column="4"
									HorizontalTextAlignment="End"
									Keyboard="Numeric"
									Text="{Binding Price}" />
							</Grid>
						</DataTemplate>
					</CollectionView.ItemTemplate>
				</CollectionView>
			</Grid>
		</Border>

		<HorizontalStackLayout Grid.Row="2" Spacing="8">
			<Button Command="{Binding SaveCommand}" Text="Сохранить" />
			<Button Command="{Binding PrintCommand}" Text="Печать" />
			<Button Command="{Binding BackCommand}" Text="Назад" />
		</HorizontalStackLayout>
	</Grid>
</ContentPage>
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
	x:Class="MyFactory.MauiClient.Pages.MaterialsAndSuppliers.SupplierOrders.SupplierOrderCompletePage"
	xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
	xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
	xmlns:view_model="clr-namespace:MyFactory.MauiClient.ViewModels.MaterialsAndSuppliers.SupplierOrders"
	Title="Завершение заказа"
	x:DataType="view_model:SupplierOrderCompletePageViewModel">
	<Grid
		Padding="16"
		RowDefinitions="Auto,Auto,*,Auto"
		RowSpacing="12">
		<Label
			FontAttributes="Bold"
			FontSize="18"
			Text="Завершение заказа" />

		<VerticalStackLayout Grid.Row="1" Spacing="4">
			<Label Text="{Binding MaterialType}" />
			<Label Text="{Binding MaterialName}" />
			<Label>
				<Label.FormattedText>
					<FormattedString>
						<Span Text="Количество: " />
						<Span Text="{Binding TotalQty}" />
						<Span Text=" " />
						<Span Text="{Binding UnitCode}" />
					</FormattedString>
				</Label.FormattedText>
			</Label>
			<Label Text="{Binding RemainingQty}" TextColor="{Binding RemainingColor}" />
		</VerticalStackLayout>

		<CollectionView
			x:Name="LinesCollection"
			Grid.Row="2"
			ItemsSource="{Binding Lines}"
			SelectionMode="None">
			<CollectionView.Header>
				<Grid
					Padding="0,4"
					ColumnDefinitions="1.2*,0.8*"
					ColumnSpacing="8">
					<Label FontAttributes="Bold" Text="Склад" />
					<Label
						Grid.Column="1"
						FontAttributes="Bold"
						HorizontalTextAlignment="End"
						Text="Количество" />
				</Grid>
			</CollectionView.Header>
			<CollectionView.ItemTemplate>
				<DataTemplate x:DataType="view_model:SupplierOrderCompletePageViewModel+ReceiveLineViewModel">
					<Grid
						Padding="0,6"
						ColumnDefinitions="1.2*,0.8*"
						ColumnSpacing="8">
						<Picker
							ItemDisplayBinding="{Binding Name}"
							ItemsSource="{Binding BindingContext.Warehouses, Source={x:Reference Name=LinesCollection}}"
							SelectedItem="{Binding Warehouse}" />
						<Entry
							Grid.Column="1"
							HorizontalTextAlignment="End"
							Keyboard="Numeric"
							Text="{Binding Qty}" />
					</Grid>
				</DataTemplate>
			</CollectionView.ItemTemplate>
		</CollectionView>

		<HorizontalStackLayout Grid.Row="3" Spacing="8">
			<Button Command="{Binding AddLineCommand}" Text="+" />
			<Button Command="{Binding CompleteCommand}" Text="Завершить" />
			<Button Command="{Binding BackCommand}" Text="Назад" />
		</HorizontalStackLayout>
	</Grid>
</ContentPage>